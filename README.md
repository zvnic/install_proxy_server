# Прокси-сервер (HTTP и SOCKS5)

Проект представляет собой Docker-based прокси-сервер с поддержкой HTTP/HTTPS (Squid) и SOCKS5 (Dante) протоколов. Настройка автоматизирована с помощью Makefile.

## Возможности

- **HTTP/HTTPS прокси** (Squid):
  - Аутентификация по имени пользователя и паролю
  - Кэширование для улучшения производительности
  - Поддержка HTTPS
  - Настраиваемые правила доступа

- **SOCKS5 прокси** (Dante):
  - Аутентификация по имени пользователя и паролю
  - Поддержка TCP/UDP
  - Настраиваемые правила доступа
  - Логирование подключений

## Требования

- Docker и Docker Compose
- Make
- Apache2-utils (для создания файлов паролей)
- curl (для проверки работоспособности)

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd proxy-server-project
```

2. Запустите установку:
```bash
make install
```

## Использование

### Запуск сервера

```bash
make setup
```

При первом запуске будет создана структура проекта и настроены контейнеры.

### Настройка портов

Для изменения портов по умолчанию:

```bash
make prompt
```

По умолчанию используются порты:
- HTTP: 3128
- SOCKS5: 1080

### Проверка статуса

```bash
make check
```

### Просмотр логов

```bash
make logs
```

### Перезапуск серверов

```bash
make restart
```

### Остановка и очистка

```bash
make clean
```

## Структура проекта

```
proxy-server/
├── docker-compose.yml
├── squid/
│   ├── Dockerfile
│   └── squid.conf
├── dante/
│   ├── Dockerfile
│   └── sockd.conf
└── credentials/
    ├── squid.passwd
    └── dante.passwd
```

## Конфигурация

### Squid (HTTP/HTTPS)

Основные настройки в `squid.conf`:
- Порт: 3128 (настраивается)
- Кэш: 256MB в памяти, 100MB на диске
- Аутентификация: Basic Auth
- Логирование: access.log, cache.log, store.log

### Dante (SOCKS5)

Основные настройки в `sockd.conf`:
- Порт: 1080 (настраивается)
- Аутентификация: username/password
- Логирование: syslog
- Правила доступа: настраиваемые

## Безопасность

- Все контейнеры запускаются с минимальными привилегиями
- Файлы с паролями имеют ограниченные права доступа (600)
- Поддерживается аутентификация для обоих прокси
- Логирование всех подключений
- Возможность ограничения доступа по IP

## Мониторинг

- Healthcheck'и для обоих сервисов
- Логирование в syslog
- Доступ к логам через docker-compose
- Проверка статуса через make check

## Устранение неполадок

### Проблемы с портами

Если порты заняты:
```bash
sudo netstat -tuln | grep -E '3128|1080'
```

### Проблемы с контейнерами

Проверка статуса:
```bash
docker ps
docker logs squid_proxy
docker logs dante_proxy
```

### Проблемы с аутентификацией

Проверка файлов паролей:
```bash
ls -l proxy-server/credentials/
```

## Лицензия

MIT

## Автор

[Ваше имя/организация]
